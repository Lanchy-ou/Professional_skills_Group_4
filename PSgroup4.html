<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Untitled</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="PSgroup4_files/libs/clipboard/clipboard.min.js"></script>
<script src="PSgroup4_files/libs/quarto-html/quarto.js"></script>
<script src="PSgroup4_files/libs/quarto-html/popper.min.js"></script>
<script src="PSgroup4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="PSgroup4_files/libs/quarto-html/anchor.min.js"></script>
<link href="PSgroup4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="PSgroup4_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="PSgroup4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="PSgroup4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="PSgroup4_files/libs/bootstrap/bootstrap-973236bd072d72a04ee9cd82dcc9cb29.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Untitled</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The effects of mercury exposure are a concern for many people, more so for dentists as mercury is contained in amalgam fillings which is a very common dental procedure. Dentists now tend to use mercury-free fillings as it is presented as a safer alternative.</p>
<p>To investigate the effects of occupational mercury exposure on dentists data was collected, where mercury exposure was measured by mercury concentration in urine. Data was collected from two groups, the first group being a random sample of 67 Scottish dentists and the second group, the control group, which consisted of 92 subjects from the University of Glasgow who were either staff or postgraduate students, who were not routinely exposed to mercury. Mercury concentrations in urine were measured alongside memory scanning times the review cognitive/neurological of mercury exposure, and the age of the participants was also collected.</p>
<p>The primary objective of this report is to investigate if there is a difference in mercury in urine concentrations between the dentist group and the control group. The secondary objectives are to see if mercury concentration in urine has an impact on memory scanning time. In addition, we will explore the relationship between mercury concentration in urine and memory scanning times between the dentist group and control group. Finally, we will consider whether age influences these potential relationships.</p>
<p>Investigating these factors will increase our understanding on the impact of occupational mercury exposure, particularly if dentists have higher mercury concentrations, how mercury exposure effects cognitive/neurological function and how age contributes to these effects.</p>
</section>
<section id="introduction-1" class="level1">
<h1>Introduction</h1>
<p>This analysis aims to explore the mercury exposure dataset in dentists and its potential effects on memory scanning reaction times. The dataset consists of observations for two groups: dentists (Group 1) and control subjects (Group 2).</p>
<p>We will perform an exploratory data analysis (EDA) to understand the structure of the data and check for any obvious patterns or relationships among the variables.</p>
<p>The data consists of 159 rows and 5 columns, as shown below:</p>
<ul>
<li><p><code>Group</code>: (1 for dentists, 2 for control).</p></li>
<li><p><code>Age</code>: Age of the subject.</p></li>
<li><p><code>Mercury</code>: Mercury concentration in urine (raw value).</p></li>
<li><p><code>UriMerc</code>: Log base 10 of mercury concentration in urine .</p></li>
<li><p><code>ReacTim</code>: Memory scanning reaction time (in milliseconds).</p></li>
</ul>
<section id="data-loading-and-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="data-loading-and-preprocessing">Data Loading and Preprocessing</h2>
<p><strong>Age</strong> has an average of 36.2 years, ranging from 22 to 44 years. <strong>Mercury</strong> and <strong>UriMerc</strong> show high variability in mercury levels, with <strong>UriMerc</strong> having some negative log-transformed values. <strong>ReacTim</strong> has a mean of 848 ms with significant variation in reaction times. The dataset has minimal missing data, with only one missing value in <strong>Age</strong>.</p>
</section>
<section id="descriptive-statistics-and-summaries" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics-and-summaries">Descriptive Statistics and Summaries</h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'performance'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:yardstick':

    mae, rmse</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Summary Statistics for Mercury Data by Group</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Group</th>
<th style="text-align: right;">Mean UriMerc</th>
<th style="text-align: right;">SD UriMerc</th>
<th style="text-align: right;">Mean Reaction Time</th>
<th style="text-align: right;">SD Reaction Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">0.355</td>
<td style="text-align: right;">888</td>
<td style="text-align: right;">199</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-0.449</td>
<td style="text-align: right;">0.495</td>
<td style="text-align: right;">817</td>
<td style="text-align: right;">158</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>What evidence is there that log (base10) mercury concentrations in urine is, on average, different for dentists compared with the control group who are not regularly exposed to mercury?</strong></p>
</section>
<section id="plot-the-distribution-of-key-variables" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-distribution-of-key-variables">Plot the Distribution of Key Variables</h2>
<section id="boxplot-of-reaction-time-by-group" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-of-reaction-time-by-group">Boxplot of Reaction Time by Group</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PSgroup4_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> Dentists have higher reaction times compared to UofG Postgraduates, with more variability and outliers in the dentists’ group. This suggests that mercury exposure might be impacting the cognitive speed of dentists more than postgraduates, or other factors may be influencing their reaction time</p>
</section>
<section id="scatterplot-of-reaction-time-vs.-mercury-concentration-log-transformed" class="level3">
<h3 class="anchored" data-anchor-id="scatterplot-of-reaction-time-vs.-mercury-concentration-log-transformed">Scatterplot of Reaction Time vs.&nbsp;Mercury Concentration (log-transformed)</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PSgroup4_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> There is a very weak positive relationship between mercury concentration and reaction time, indicating that higher mercury levels in urine may have a slight effect on slowing reaction times. However, the weak correlation suggests that other factors may be influencing reaction time more significantly than mercury concentration alone.</p>
</section>
<section id="scatterplot-of-age-vs.-reaction-time-and-mercury" class="level3">
<h3 class="anchored" data-anchor-id="scatterplot-of-age-vs.-reaction-time-and-mercury">Scatterplot of Age vs.&nbsp;Reaction Time and Mercury</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PSgroup4_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> There’s no clear relationship between age and reaction time, suggesting that age does not significantly affect cognitive speed in either group. This might imply that age-related decline in cognitive function isn’t a major factor in the observed reaction times, or that age ranges in the data are not broad enough to show a noticeable trend.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation between Reaction Time and Age:  0.0455153872092546"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation between Mercury Concentration and Age:  NA"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2027467</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PSgroup4_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> The weak negative correlation between age and mercury concentration suggests that older individuals tend to have lower mercury levels in their urine. This could imply that mercury exposure decreases with age, possibly due to reduced exposure or natural biological changes. However, the relationship is weak, indicating that other factors might be more influential on mercury concentration than age.</p>
</section>
</section>
</section>
<section id="sec-mt" class="level1">
<h1>Models to be fitted</h1>
<section id="primary-objective" class="level2">
<h2 class="anchored" data-anchor-id="primary-objective">Primary objective:</h2>
<section id="a" class="level3">
<h3 class="anchored" data-anchor-id="a">(a)</h3>
<p>A two-samples t-test was conducted to directly compare the mean log (base 10) Mercury concentration between the two groups Null hypothesis in both cases:</p>
<p><span class="math inline">\(H_0\)</span>:There is no significant difference in the mean UriMerc between the two groups.(<span class="math inline">\(μ_1\)</span>=<span class="math inline">\(μ_2\)</span>)</p>
<p><span class="math inline">\(H_1\)</span>:There is a significant difference in the mean UriMerc between the two groups. (<span class="math inline">\(μ_1\)</span><span class="math inline">\(\neq\)</span><span class="math inline">\(μ_2\)</span>)</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>P_value: 1.667636e-20 </code></pre>
</div>
</div>
<p>We performed a t-test comparing the mean log(base 10)-transformed urinary mercury concentration (UriMerc) between the groups and got a p-value of 1.667636e-20. Since this is much less than 0.05, we reject the null hypothesis and conclude that the groups have significantly different mean mercury levels.</p>
</section>
</section>
<section id="secondary-objective" class="level2">
<h2 class="anchored" data-anchor-id="secondary-objective">Secondary objective:</h2>
<section id="b" class="level3">
<h3 class="anchored" data-anchor-id="b">(b)</h3>
<p>We start by fitting a simple linear regression model: <span class="math display">\[
y_i = \alpha + \beta_1 x_{1i}+\epsilon_i
\\=\alpha+\beta_{UriMerc}\cdot UriMerc
\]</span></p>
<div class="cell">
<div id="tbl-m1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-m1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Estimates of the regression model1 coefficients.
</figcaption>
<div aria-describedby="tbl-m1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="jfymdijdry" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jfymdijdry table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jfymdijdry thead, #jfymdijdry tbody, #jfymdijdry tfoot, #jfymdijdry tr, #jfymdijdry td, #jfymdijdry th {
  border-style: none;
}

#jfymdijdry p {
  margin: 0;
  padding: 0;
}

#jfymdijdry .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jfymdijdry .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jfymdijdry .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jfymdijdry .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jfymdijdry .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jfymdijdry .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jfymdijdry .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jfymdijdry .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jfymdijdry .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jfymdijdry .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jfymdijdry .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jfymdijdry .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jfymdijdry .gt_spanner_row {
  border-bottom-style: hidden;
}

#jfymdijdry .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jfymdijdry .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jfymdijdry .gt_from_md > :first-child {
  margin-top: 0;
}

#jfymdijdry .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jfymdijdry .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jfymdijdry .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jfymdijdry .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jfymdijdry .gt_row_group_first td {
  border-top-width: 2px;
}

#jfymdijdry .gt_row_group_first th {
  border-top-width: 2px;
}

#jfymdijdry .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jfymdijdry .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jfymdijdry .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jfymdijdry .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jfymdijdry .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jfymdijdry .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jfymdijdry .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jfymdijdry .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jfymdijdry .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jfymdijdry .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jfymdijdry .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jfymdijdry .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jfymdijdry .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jfymdijdry .gt_left {
  text-align: left;
}

#jfymdijdry .gt_center {
  text-align: center;
}

#jfymdijdry .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jfymdijdry .gt_font_normal {
  font-weight: normal;
}

#jfymdijdry .gt_font_bold {
  font-weight: bold;
}

#jfymdijdry .gt_font_italic {
  font-style: italic;
}

#jfymdijdry .gt_super {
  font-size: 65%;
}

#jfymdijdry .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jfymdijdry .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jfymdijdry .gt_indent_1 {
  text-indent: 5px;
}

#jfymdijdry .gt_indent_2 {
  text-indent: 10px;
}

#jfymdijdry .gt_indent_3 {
  text-indent: 15px;
}

#jfymdijdry .gt_indent_4 {
  text-indent: 20px;
}

#jfymdijdry .gt_indent_5 {
  text-indent: 25px;
}

#jfymdijdry .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jfymdijdry div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">term</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">estimate</th>
<th id="std.error" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">std.error</th>
<th id="statistic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">statistic</th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">p.value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="term">(Intercept)</td>
<td class="gt_row gt_right" headers="estimate">849.74666</td>
<td class="gt_row gt_right" headers="std.error">14.70629</td>
<td class="gt_row gt_right" headers="statistic">57.7811549</td>
<td class="gt_row gt_right" headers="p.value">1.057334e-107</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">UriMerc</td>
<td class="gt_row gt_right" headers="estimate">14.23289</td>
<td class="gt_row gt_right" headers="std.error">24.93071</td>
<td class="gt_row gt_right" headers="statistic">0.5708978</td>
<td class="gt_row gt_right" headers="p.value">5.688852e-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>As the table show the intercept is about 849.75, meaning that when UriMerc is 0, the predicted outcome is 849.75. The coefficient for UriMerc is 14.23, indicating that for each one-unit increase in UriMerc, the outcome is expected to increase by 14.23 units. However, this effect is not statistically significant (p = 0.569), suggesting that UriMerc does not have a clear impact on the outcome in this model.</p>
</section>
<section id="c" class="level3">
<h3 class="anchored" data-anchor-id="c">(c)</h3>
<p>We fit the full multiple regression model containing all explanatory variables and separate regression lines for each group. The full model can be written as: <span class="math display">\[
y_i = \alpha + \beta_1 x_{1i} +\beta_2 x_{2i} +\beta_3 x_{1i} x_{2i} +\epsilon_i
\\=\alpha+\beta_{UriMerc}\cdot UriMerc+\beta_{Group}\cdot \mathbb{I}_{\mathrm{Group}}(x)+\beta_{UriMerc,Group}\cdot UriMerc\cdot \mathbb{I}_{\mathrm{Group}}(x)
\]</span> where</p>
<p>- <span class="math inline">\(\alpha\)</span>: Baseline intercept (predicted outcome for Group 1 when <span class="math inline">\(UriMerc\)</span>=0).</p>
<p>- <span class="math inline">\(\beta_{UriMerc}\)</span>: Effect of <span class="math inline">\(UriMerc\)</span> on the outcome in Group 1.</p>
<p>- <span class="math inline">\(\beta_{Group}\)</span>: Change in intercept for Group 2 compared to Group 1.</p>
<p>- <span class="math inline">\(\beta_{UriMerc,Group}\)</span>: Change in the effect (slope) of <span class="math inline">\(UriMerc\)</span> for Group 2 compared to Group 1.</p>
<p>- <span class="math inline">\(\mathbb{I}_{\mathrm{Group}}(x)\)</span>: Indicator variable that equals 1 for Group 2 and 0 for Group 1.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
stats::lm(formula = ReacTim ~ UriMerc * Group, data = data)

Coefficients:
   (Intercept)         UriMerc          Group2  UriMerc:Group2  
        912.85          -92.99         -103.42           73.38  </code></pre>
</div>
</div>
<div class="cell">
<div id="tbl-regtable" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-regtable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Estimates of the regression model coefficients.
</figcaption>
<div aria-describedby="tbl-regtable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<caption>Full Regression model with interaction term</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std_error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p_value</th>
<th style="text-align: right;">lower_ci</th>
<th style="text-align: right;">upper_ci</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">intercept</td>
<td style="text-align: right;">912.851</td>
<td style="text-align: right;">27.074</td>
<td style="text-align: right;">33.717</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">859.369</td>
<td style="text-align: right;">966.333</td>
</tr>
<tr class="even">
<td style="text-align: left;">UriMerc</td>
<td style="text-align: right;">-92.985</td>
<td style="text-align: right;">60.925</td>
<td style="text-align: right;">-1.526</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: right;">-213.336</td>
<td style="text-align: right;">27.366</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group: 2</td>
<td style="text-align: right;">-103.424</td>
<td style="text-align: right;">36.783</td>
<td style="text-align: right;">-2.812</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">-176.085</td>
<td style="text-align: right;">-30.762</td>
</tr>
<tr class="even">
<td style="text-align: left;">UriMerc:Group2</td>
<td style="text-align: right;">73.382</td>
<td style="text-align: right;">71.182</td>
<td style="text-align: right;">1.031</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">-67.231</td>
<td style="text-align: right;">213.994</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>From the coefficient table, the intercept (912.851) represents the predicted reaction time for Group 1 when UriMerc=0. The coefficient for UriMerc (-92.985) implies that each 1-unit increase in UriMerc would lower reaction time by about 93 ms in Group 1, although this effect is not statistically significant (p=0.129). Meanwhile, the coefficient for Group 2 (-103.424) indicates that, at UriMerc=0, reaction time is approximately 103 ms lower than in Group 1 (p=0.006). Finally, the interaction term (73.382) suggests that the slope of UriMerc for Group 2 is 73 ms higher than for Group 1, but this difference is not statistically significant (p=0.304).</p>
<p>And from table we obtain our best-fitting line to the data is: <span class="math display">\[
\widehat{ReacTim}=912.851-92.985    \cdot UriMerc-103.424\cdot \mathbb{I}_{\mbox{Group}}(x)+73.382\cdot UriMerc\cdot \mathbb{I}_{\mbox{Group}}(x)
\]</span><br>
<a href="#fig-scat1" class="quarto-xref">Figure&nbsp;1</a> shows how the relationship between urinary mercury concentration (UriMerc) and reaction time (ReacTim) differs by group. Each group has its own regression line, indicating that the effect of UriMerc on ReacTim varies depending on group membership.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scat1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scat1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="PSgroup4_files/figure-html/fig-scat1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scat1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Relationship between reaction time and UriMerc by groups with regression lines superimposed
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-resids" class="quarto-xref">Figure&nbsp;2</a> plots the residuals against both UriMerc and the fitted values, grouped by the two categories. The points appear evenly scattered around zero, suggesting that the residuals have a mean of zero and no obvious pattern that would indicate non-constant variance or a missing variable. The variance of the residuals looks relatively consistent across all levels of UriMerc and the fitted values, indicating homoscedasticity.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-resids" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resids-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="PSgroup4_files/figure-html/fig-resids-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resids-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Residual versus UriMerc (left) and the fitted values (right) by species.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-residhist" class="quarto-xref">Figure&nbsp;3</a> shows histograms of the residuals for each group. Both distributions appear roughly bell-shaped and centered around zero, suggesting the residuals are normally distributed with a mean of zero. This supports the assumption of normality.However, deviations at the tails indicate potential outliers or heavier tails, suggesting a slightly non-normal distribution in extreme values.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-residhist" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residhist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="PSgroup4_files/figure-html/fig-residhist-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residhist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Histograms of the residuals by species.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="d" class="level3">
<h3 class="anchored" data-anchor-id="d">(d)</h3>
<p>We need to add one covariates age to the full model: <span class="math display">\[
y_i = \alpha + \beta_1 x_{1i} +\beta_2 x_{2i} +\beta_3 x_{1i} x_{2i} +\beta_4x_{3i}+\epsilon_i
\\=\alpha+\beta_{UriMerc}\cdot UriMerc+\beta_{Group}\cdot \mathbb{I}_{\mathrm{Group}}(x)+\beta_{UriMerc,Group}\cdot UriMerc\cdot \mathbb{I}_{\mathrm{Group}}(x)+\beta_{age}\cdot Age
\]</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
stats::lm(formula = ReacTim ~ UriMerc * Group + Age, data = data)

Coefficients:
   (Intercept)         UriMerc          Group2             Age  UriMerc:Group2  
       713.731         -81.283         -77.053           4.973          52.907  </code></pre>
</div>
</div>
<div class="cell">
<div id="tbl-age" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Estimates of the regression model coefficients.
</figcaption>
<div aria-describedby="tbl-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<caption>Regression model with interaction term</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std_error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p_value</th>
<th style="text-align: right;">lower_ci</th>
<th style="text-align: right;">upper_ci</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">intercept</td>
<td style="text-align: right;">713.731</td>
<td style="text-align: right;">60.427</td>
<td style="text-align: right;">11.811</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">594.352</td>
<td style="text-align: right;">833.110</td>
</tr>
<tr class="even">
<td style="text-align: left;">UriMerc</td>
<td style="text-align: right;">-81.283</td>
<td style="text-align: right;">58.865</td>
<td style="text-align: right;">-1.381</td>
<td style="text-align: right;">0.169</td>
<td style="text-align: right;">-197.577</td>
<td style="text-align: right;">35.011</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group: 2</td>
<td style="text-align: right;">-77.053</td>
<td style="text-align: right;">36.205</td>
<td style="text-align: right;">-2.128</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">-148.579</td>
<td style="text-align: right;">-5.527</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age</td>
<td style="text-align: right;">4.973</td>
<td style="text-align: right;">1.361</td>
<td style="text-align: right;">3.654</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.284</td>
<td style="text-align: right;">7.662</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UriMerc:Group2</td>
<td style="text-align: right;">52.907</td>
<td style="text-align: right;">69.263</td>
<td style="text-align: right;">0.764</td>
<td style="text-align: right;">0.446</td>
<td style="text-align: right;">-83.928</td>
<td style="text-align: right;">189.742</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>As the <a href="#tbl-age" class="quarto-xref">Table&nbsp;3</a> shows, the coefficient for age is 4.973, meaning that for each additional year of age, the reaction time increases by about 5 milliseconds, holding all other variables constant. This effect is statistically significant (p&lt;0.001), with a 95% confidence interval ranging from approximately 2.3 to 7.7 milliseconds.</p>
<div class="cell">
<div id="tbl-MC" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-MC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Model Comparison
</figcaption>
<div aria-describedby="tbl-MC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<caption>Model Comparison Values for different models.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">2100.98</td>
<td style="text-align: right;">2116.32</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">2077.44</td>
<td style="text-align: right;">2095.81</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>As the <a href="#tbl-MC" class="quarto-xref">Table&nbsp;4</a> shows, Model 2, which includes age, shows a higher adjusted R-square (0.11 compared to 0.03) and lower AIC (2077.44 vs.&nbsp;2100.98) and BIC (2095.81 vs.&nbsp;2116.32) values than Model 1. This indicates that the extended model provides a better balance between goodness-of-fit and model complexity, suggesting that adding age improves the model performance and should be preferred.</p>
</section>
</section>
</section>
<section id="discussions-and-conclusions" class="level1">
<h1>Discussions and Conclusions</h1>
<section id="summary-of-findings" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-findings">Summary of Findings</h2>
</section>
<section id="limitations" class="level2">
<h2 class="anchored" data-anchor-id="limitations">Limitations</h2>
<p>While this study gives a great insight into the effect of mercury on dentists, it also has many limitations.</p>
<p>The first limitation of this study is the small sample size. The results are not generalizable to a large population as it only investigates Scottish dentists and staff and students from Glasgow University. This could be counteracted by using a random sample of dentists in the UK or worldwide, and the control group being a random selection of non-dentists.</p>
<p>Another limitation of this study, closely related to the sample size, is the non-randomized study design. The dentists and the controls are not randomly assigned to their groups in this study. This study could benefit from a randomized design to investigate the true relationship between mercury and reaction time without any bias.</p>
<p>Another limitation is the amount of confounding variables such as age, sex, education, and medical conditions. All of these factors could affect reaction time and mercury exposure. Even though all participants have been or are going to university there could be a real difference in intellectual ability and therefore reaction time. Even other medical conditions could affect mercury concentration and reaction time in participants. Certain diets and food, such as tuna fish, also contribute to the levels of mercury in urine and this could affect findings. All of these variables would need to be controlled or kept constant to keep the validity of the study.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>